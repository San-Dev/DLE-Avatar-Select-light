function avaModalClose(){$("body").removeClass("ava-noBody"),$(".ava-modal").fadeOut(400,function(){$(this).remove()})}function avaUpdate(t){$("[data-foto]").each(function(){"background"==$(this).data("foto")?$(this).css({backgroundImage:"url("+t+")"}):$(this).attr("src",t)}),$(".ava-modal-content-list li.current").addClass("active").siblings().removeClass("active"),ModAlert.addAlert({type:"success",text:"Ваше фото успешно обновлено"})}function avaAjax(t,e){ShowLoading(),t.skin=dle_skin,$.ajax({url:dle_root+"engine/mods/AvatarSelect/ajax.php",type:"POST",dataType:"json",data:t}).done(function(t){t.error?ModAlert.addAlert({type:"error",text:t.error}):e(t)}).error(function(t){ModAlert.addAlert({type:"error",text:t.responseText})}).always(function(){HideLoading()})}document.write('<link media="screen" href="/engine/mods/AvatarSelect/assets/style.css" type="text/css" rel="stylesheet" />'),$(document).on("click",".ava-modal-content-list li:not(.current) img",function(t){t.preventDefault(),$(this).parents("li").addClass("current").siblings().removeClass("current")}).on("click","body",function(t){"ava-modal"==t.target.className&&avaModalClose()}).on("click",".ava-modal-trigger",function(t){t.preventDefault(),$(".ava-modal").remove(),$("body").append('<div class="ava-modal" />'),avaAjax({skin:dle_skin},function(t){$("body").addClass("ava-noBody"),$(".ava-modal").html(t.html).fadeIn(300)})}).on("dblclick",".ava-modal-content-list li img",function(){avaAjax({action:"save",foto:$(this).attr("src")},function(t){avaUpdate(t.src)})}).on("click",".ava-modal-close",function(t){t.preventDefault(),avaModalClose()}).on("click",".ava-button-save",function(t){t.preventDefault(),avaAjax({action:"save",foto:$(".ava-modal-content-list li.current img").attr("src")},function(t){avaUpdate(t.src)})});var ModAlert={config:{type:"",title:"",text:"",timeout:3e3,autohide:!0,showicon:!0,notitle:!1},type:{success:"Успешно",info:"Информация",warning:"Внимание!",error:"Ошибка"},addAlert:function(t){var e=this;$(".modAlert").length<1&&$("body").append('<div class="modAlert"></div>');var a=$.extend({},this.config,t);a.title||(this.type[a.type]?a.title=this.type[a.type]:a.type&&(a.title=a.type));var o=["modAlert-item"];a.type&&o.push("modAlert-"+a.type),a.showicon||o.push("modAlert-noicon"),a.title&&a.text&&!a.notitle||(o.push("modAlert-onerow"),a.notitle&&o.push("modAlert-notitle"));var n='<div class="'+o.join(" ")+'">';a.showicon&&(n+='<div class="modAlert-icon"></div>'),a.title&&!a.notitle&&(n+='<div class="modAlert-title">'+a.title+"</div>"),a.text&&(n+='<div class="modAlert-text">'+a.text+"</div>"),n+="</div>";var i=$(n);return i.appendTo(".modAlert").slideDown(200),i.click(function(){e.hideItem($(this))}),a.autohide&&a.timeout>0&&setTimeout(function(){e.hideItem(i)},a.timeout),!1},hideItem:function(t){t.animate({left:"-"+$(".modAlert").outerWidth()},220,function(){$(this).remove(),$(".modAlert-item").length<1&&$(".modAlert").remove()})}};